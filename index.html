<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHARK RNG | Global Leaderboard</title>
    <style>
        :root {
            --bg: #01060f;
            --accent: #00f2ff;
            --panel: rgba(0, 15, 30, 0.95);
            /* Rarity Colors */
            --c-COMMON: #a0a0a0; --c-UNCOMMON: #4caf50; --c-RARE: #2196f3;
            --c-EPIC: #9c27b0; --c-LEGENDARY: #ffc107; --c-ABYSSAL: #ff3d00;
            --c-SUNKEN: #00ffcc; --c-PREHISTORIC: #ffffff;
        }

        body, html {
            margin: 0; padding: 0; height: 100%;
            background: var(--bg); color: white;
            font-family: 'Segoe UI', sans-serif;
            overflow: hidden; user-select: none;
        }

        /* --- UI OVERLAYS --- */
        .overlay {
            position: fixed; inset: 0; background: #000; z-index: 4000;
            display: none; flex-direction: column; padding: 40px;
        }

        /* --- THE SHARK ENGINE --- */
        .shark-container {
            position: relative; width: 300px; height: 150px;
            display: flex; justify-content: center; align-items: center;
            animation: global-swim 4s infinite ease-in-out;
        }
        .shark-part { position: absolute; background: var(--accent); box-shadow: 0 0 20px var(--accent); }
        .shark-body { width: 130px; height: 55px; border-radius: 50% 50% 40% 40%; left: 85px; }
        .shark-fin { width: 0; height: 0; border-left: 25px solid transparent; border-right: 25px solid transparent; border-bottom: 45px solid var(--accent); top: -30px; left: 125px; }
        .shark-tail { width: 0; height: 0; border-top: 30px solid transparent; border-bottom: 30px solid transparent; border-left: 45px solid var(--accent); left: 50px; animation: tail-wag 0.6s infinite ease-in-out; }
        .shark-eye { width: 7px; height: 7px; background: black; border-radius: 50%; top: 15px; right: 25px; position: absolute; }

        @keyframes global-swim { 0%, 100% { transform: translateX(-20px) rotate(-2deg); } 50% { transform: translateX(20px) rotate(2deg); } }
        @keyframes tail-wag { 0%, 100% { transform: rotateY(0deg); } 50% { transform: rotateY(45deg); } }
        .fast-swim { animation-duration: 0.2s !important; }

        .side-panel {
            position: absolute; top: 100px; bottom: 100px; width: 280px;
            background: var(--panel); border: 1px solid rgba(0, 242, 255, 0.2);
            border-radius: 20px; display: flex; flex-direction: column; overflow: hidden;
        }
        #inventory-panel { left: 20px; }
        #perks-panel { right: 20px; }
        .p-head { padding: 15px; background: rgba(0, 242, 255, 0.1); text-align: center; font-weight: bold; }
        .p-content { flex: 1; overflow-y: auto; padding: 15px; }

        #reveal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            z-index: 5000; display: none; flex-direction: column; justify-content: center; align-items: center;
        }

        .btn { padding: 10px 20px; cursor: pointer; border-radius: 5px; border: 1px solid var(--accent); background: transparent; color: white; margin: 5px; }
        #roll-btn { padding: 25px 80px; font-size: 1.5rem; border-radius: 50px; background: #fff; color: #000; font-weight: 900; border: none; box-shadow: 0 0 30px var(--accent); }
    </style>
</head>
<body>

    <audio id="bg-music" loop>
        <source src="The OneUps - Super Mario Kart - Koopa Beach.mp3" type="audio/mpeg">
    </audio>

    <div id="start-screen" class="overlay" style="display:flex; justify-content:center; align-items:center;">
        <h1 style="font-size: 5rem; letter-spacing: 15px; color: var(--accent);">SHARK RNG</h1>
        <button id="roll-btn" onclick="beginGame()">BEGIN HUNT</button>
    </div>

    <div id="leaderboard-overlay" class="overlay">
        <h1 style="color:var(--accent)">GLOBAL TOP HUNTERS</h1>
        <div id="lb-list" style="flex:1; overflow-y:auto; font-family:monospace; font-size: 1.2rem;">Loading...</div>
        <button class="btn" onclick="closeOverlay('leaderboard-overlay')" style="margin-top:20px">BACK</button>
    </div>

    <div id="reveal" onclick="closeReveal()">
        <div id="rev-icon" style="font-size:150px">ðŸ¦ˆ</div>
        <div id="rev-name" style="font-size: 3rem; font-weight: 900;">SHARK NAME</div>
        <div id="rev-odds">1 / 100</div>
    </div>

    <div id="main-game" style="display:none; height:100%; flex-direction:column; justify-content:space-between; align-items:center; padding:40px;">
        <div class="side-panel" id="inventory-panel">
            <div class="p-head">RECENT CATCHES</div>
            <div id="inv-list" class="p-content"></div>
        </div>

        <div style="text-align:center;">
            <div class="shark-container" id="shark-engine">
                <div class="shark-tail shark-part"></div>
                <div class="shark-body shark-part"><div class="shark-eye"></div></div>
                <div class="shark-fin shark-part"></div>
            </div>
            <div style="margin-top:80px;">
                <button id="roll-btn" onclick="roll()">DROP BAIT</button>
                <h2>ROLLS: <span id="stat-rolls">0</span></h2>
                <button class="btn" onclick="openLeaderboard()">VIEW LEADERBOARD</button>
            </div>
        </div>

        <div class="side-panel" id="perks-panel">
            <div class="p-head">UPGRADES</div>
            <div id="perk-list" class="p-content"></div>
        </div>
    </div>

    <script>
        // --- PUT YOUR DREAMLO KEYS HERE ---
        const PUBLIC_KEY = "PASTE_YOUR_PUBLIC_KEY_HERE";
        const PRIVATE_KEY = "PASTE_YOUR_PRIVATE_KEY_HERE";

        const RARITIES = {
            COMMON: { w: 1, c: "#a0a0a0" }, UNCOMMON: { w: 5, c: "#4caf50" },
            RARE: { w: 25, c: "#2196f3" }, EPIC: { w: 100, c: "#9c27b0" },
            LEGENDARY: { w: 1000, c: "#ffc107" }, ABYSSAL: { w: 10000, c: "#ff3d00" },
            PREHISTORIC: { w: 100000, c: "#ffffff" }
        };

        const ITEMS = [
            { n: "Tiny Guppy", i: "ðŸŸ", r: "COMMON" },
            { n: "Baby Shark", i: "ðŸ¦ˆ", r: "UNCOMMON" },
            { n: "Crab King", i: "ðŸ¦€", r: "RARE" },
            { n: "Giant Squid", i: "ðŸ¦‘", r: "EPIC" },
            { n: "Great White", i: "ðŸ¦ˆ", r: "LEGENDARY" },
            { n: "Magma Shark", i: "ðŸŒ‹", r: "ABYSSAL" },
            { n: "Megalodon", i: "ðŸ¦´", r: "PREHISTORIC" }
        ];

        let state = { rolls: 0, inv: {}, perks: [], name: "" };

        function beginGame() {
            state.name = prompt("Enter Hunter Name (No Spaces):") || "SharkHunter";
            state.name = state.name.replace(/\s/g, ''); // Fix spaces for Dreamlo
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('main-game').style.display = 'flex';
            
            // Starts music upon button click
            document.getElementById('bg-music').play();
            updateUI();
        }

        function roll() {
            if (state.rolling) return;
            state.rolling = true;
            state.rolls++;
            document.getElementById('roll-btn').disabled = true;
            document.getElementById('shark-engine').classList.add('fast-swim');

            setTimeout(() => {
                let tier = "COMMON";
                const sorted = Object.keys(RARITIES).sort((a,b) => RARITIES[b].w - RARITIES[a].w);
                for (let r of sorted) {
                    if (Math.random() < (1 / RARITIES[r].w)) { tier = r; break; }
                }

                const possible = ITEMS.filter(i => i.r === tier);
                const item = possible[Math.floor(Math.random() * possible.length)];
                
                if (!state.inv[item.n]) state.inv[item.n] = 0;
                state.inv[item.n]++;

                // Automatically update leaderboard every 10 rolls
                if (state.rolls % 10 === 0) submitScore();

                showReveal(item);
                updateUI();
                state.rolling = false;
                document.getElementById('shark-engine').classList.remove('fast-swim');
            }, 800);
        }

        function showReveal(item) {
            document.getElementById('rev-icon').innerText = item.i;
            document.getElementById('rev-name').innerText = item.n;
            document.getElementById('rev-name').style.color = RARITIES[item.r].c;
            document.getElementById('rev-odds').innerText = "1 / " + RARITIES[item.r].w.toLocaleString();
            document.getElementById('reveal').style.display = 'flex';
        }

        function closeReveal() { document.getElementById('reveal').style.display = 'none'; document.getElementById('roll-btn').disabled = false; }

        function updateUI() {
            document.getElementById('stat-rolls').innerText = state.rolls;
            const list = document.getElementById('inv-list');
            list.innerHTML = Object.entries(state.inv).reverse().map(([n, c]) => `<div>${n} x${c}</div>`).join('');
        }

        function openLeaderboard() {
            document.getElementById('leaderboard-overlay').style.display = 'flex';
            document.getElementById('lb-list').innerHTML = "Fetching top hunters...";
            
            fetch(`https://www.dreamlo.com/lb/${PUBLIC_KEY}/json`)
                .then(r => r.json()).then(d => {
                    if (!d.dreamlo.leaderboard) {
                        document.getElementById('lb-list').innerHTML = "No scores yet!";
                        return;
                    }
                    let e = d.dreamlo.leaderboard.entry;
                    if(!Array.isArray(e)) e = [e];
                    document.getElementById('lb-list').innerHTML = e.map((i, idx) => `
                        <div style="padding:10px; border-bottom:1px solid #222;">
                            #${idx+1} ${i.name} â€” ${i.score} Rolls
                        </div>
                    `).join('');
                });
        }

        function submitScore() {
            fetch(`https://www.dreamlo.com/lb/${PRIVATE_KEY}/add/${state.name}/${state.rolls}`);
        }

        function closeOverlay(id) { document.getElementById(id).style.display = 'none'; }
    </script>
</body>
</html>
